removeSpaces <- function(...) gsub(" ","", ... , fixed=TRUE)
replaceSpacesWithCommas <- function(...) gsub('^ *|(?<= ) | *$',",", ... , fixed=TRUE)


mainTitle <- "2D Position Discovery"
pdfFileName <- paste(removeSpaces(mainTitle),".pdf",sep="")
pngFileName <- paste(removeSpaces(mainTitle),".png",sep="")

# DF olmuyo bu, matrix olacak
data2D <- matrix(data = NA, nrow = 4, ncol = 2, byrow = TRUE, dimnames = list(c("1RefNode","2RefsParallel", "2RefsDiagonal", "2RefsTriangular"),c("Avg_maxError","Avg_meanError")))



data2D[1,] <- c(1.003,0.41)
data2D[2,] <- c(0.90,0.38)
data2D[3,] <- c(1.21,0.35)
data2D[4,] <- c(1.11,0.33)

#pdf(pdfFileName)
bp <- barplot(data2D, beside=TRUE,col=c("blue","lightblue", "mistyrose", "lavender"),main=mainTitle,ylab="Error", ylim=c(0, 1.3))
text(bp, y=0, labels=rep(rownames(data2D),2),cex=1,pos=4,srt=90)
text(bp, data2D, labels=as.character(data2D),cex=1,pos=3,srt=0)
#dev.off()


# Convert pdf to png
#system(paste("sips -s format png",pdfFileName,"--out",pngFileName))

#multipath

failIndicesStr <- "1    7    8    9   10   11   12   13   14   15   16   17   18   19   20  21   22   25   30   32   34   35   40   45   46   50   53   54   63   64  65   69   71   76   82   83   87   88   93   96   97  102  103  105  106  107  108  110  116  120  121  126  129  131  133  136  137  141  146  151  158  159  165  169  173  174  176  183  188  189  193  194  195  203  204  206  207  209  211  212  213  214  215  216  218  219  220  223  240  258  273  280  282  283  285  288  289  291  292  294  295  296  297  298  305  310  311  329  330 1825 1826 1831 1832 1836 1839 1841 1842 1848 1851 1862 1864 1878 1879 1891 1893 1895 1910 1949 1997"

failIndices <- c(1,   7,   8,   9,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20, 21,  22,  25,  30,  32,  34,  35,  40,  45,  46,  50,  53,  54,  63,  64, 65,  69,  71,  76,  82,  83,  87,  88,  93,  96,  97, 102, 103, 105, 106, 107, 108, 110, 116, 120, 121, 126, 129, 131, 133, 136, 137, 141, 146, 151, 158, 159, 165, 169, 173, 174, 176, 183, 188, 189, 193, 194, 195, 203, 204, 206, 207, 209, 211, 212, 213, 214, 215, 216, 218, 219, 220, 223, 240, 258, 273, 280, 282, 283, 285, 288, 289, 291, 292, 294, 295, 296, 297, 298, 305, 310, 311, 329, 330,1825,1826,1831,1832,1836,1839,1841,1842,1848,1851,1862,1864,1878,1879,1891,1893,1895,1910,1949,1997)

if (FALSE)
{
	con <- textConnection("1    7    8    9   10   11   12   13   14   15   16   17   18   19   20  21   22   25   30   32   34   35   40   45   46   50   53   54   63   64
	  65   69   71   76   82   83   87   88   93   96   97  102  103  105  106  107  108  110  116  120  121  126  129  131  133  136  137  141  146  151  158  159  165  169  173  174  176  183  188  189  193  194  195  203  204  206  207  209  211  212  213  214  215  216  218  219  220  223  240  258  273  280  282  283  285  288  289  291  292  294  295  296  297  298  305  310  311  329  330 1825 1826 1831 1832 1836 1839 1841 1842 1848 1851 1862 1864 1878 1879 1891 1893 1895 1910 1949 1997")
	dat <- read.table(con, fill = TRUE, stringsAsFactors = FALSE)
	close(con)
	
	fi <- replaceSpacesWithCommas(failIndices)
	fi <- strsplit(fi,",")
	as.numeric(fi)
}
#Single path
failIndicesStr <- "1   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  25 30  32  34  35  40  45  46  50  53  54  63  64  65  69  71  76  82  83
 87  88  93  96  97 102 103 105 106 107 108 110 116 120 121 126 129 131 133 136 137 141 146 151 158 159 165 169 173 174 176 183 188 189 193 194 195 203 204 206 207 209 211 212 213 214 215 216 218 219 220 223 233 238 240 243 244 245 246 248 249 251 253 258 273 280 281 282 283 285 288 289 291 292 294 295 296 297 298 299 305 310 311 329 330"
 gsub(" {1,}",",", failIndicesStr)
 failIndicesX <- c(1,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25,30, 32, 34, 35, 40, 45, 46, 50, 53, 54, 63, 64, 65, 69, 71, 76, 82, 83,87, 88, 93, 96, 97,102,103,105,106,107,108,110,116,120,121,126,129,131,133,136,137,141,146,151,158,159,165,169,173,174,176,183,188,189,193,194,195,203,204,206,207,209,211,212,213,214,215,216,218,219,220,223,233,238,240,243,244,245,246,248,249,251,253,258,273,280,281,282,283,285,288,289,291,292,294,295,296,297,298,299,305,310,311,329,330)
 
#2ndRowNormal
failIndicesX <- c(364,365,427,428,429,437,440,441,456,460,461,465,509,510,511,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,674,675,686,691,694,695,697,701,703,706,710,715,716,721,724,726,727,728,729,730,732,733,734,737,738,739,742,743,744,748,774,775,778,779,780,782,783,784,785,786,792,813,834,905,906,908,909,929,939,942,943,950,970,983,984,985,986,987,988,989,991,1012,1013,1014,1015,1016,1017,1018,1021,1022,1023,1024,1025,1027,1028,1048,1051,1054,1055,1056,1058,1064,1065,1069,1070,1071,1072,1073,1074,1075,1076,1077,1079,1086,1090,1091,1092,1094,1095,1096,1098,1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,1112,1113,1114,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1132,1133,1134,1135,1136,1137,1138,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,1151,1152,1153,1154,1155,1156,1157,1158,1159,1160,1161,1162,1163,1164,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,1177,1178,1179,1180,1181,1182,1183,1184,1185,1186,1187,1188,1189,1190,1191,1192,1193,1194,1195,1196,1197,1198,1199,1200,1201,1202,1203,1204,1205,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1221,1222,1223,1224,1225,1226,1227,1228,1229,1230,1231,1232,1233,1234,1235,1236,1237,1238,1239,1240,1241,1242,1243,1244,1245,1246,1247,1248,1249,1250,1251,1252,1253,1254,1255,1256,1257,1258,1259,1260,1261,1262,1263,1264,1265,1266,1267,1268,1269,1270,1271,1272,1273,1274,1275,1276,1277,1278,1279,1280,1281,1282,1283,1284,1285,1286,1287,1288,1289,1290,1291,1292,1293,1294,1295,1296,1297,1298,1299,1300,1301,1302,1303,1304,1305,1306,1307,1308,1309,1310,1312,1313,1315,1316,1317,1319,1320,1321,1322,1323,1324,1325,1326,1327,1328,1329,1330,1331,1332,1333,1334,1335,1336,1337,1338,1339,1340,1341,1342,1343,1344,1345,1346,1347,1348,1349,1350,1351,1352,1353,1354,1355,1356,1357,1358,1359,1360,1361,1362,1365,1366,1367,1368,1369,1370,1371,1372,1373,1374,1375,1376,1377,1378,1379,1380,1381,1383,1384,1385,1386,1387,1388,1390,1391,1392,1393,1394,1395,1396,1397,1398,1399,1401,1402,1406,1407,1408,1409,1422,1424,1591,1593,1624,1648,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1723,1727,1728,1729,1730,1731,1736,1738,1739,1741,1742,1743,1744,1745,1746,1747,1748,1749,1750,1751,1753,1754,1755,1758,1759,1763,1765,1766,1768,1769,1770,1771,1772,1773,1775,1776,1781,1782,1783,1784,1786,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1806,1807,1808,1809,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1840,1841,1842,1844,1845,1846,1847,1850,1851,1852,1854,1857,1858,1859,1860,1861,1862,1863,1864,1865,1871,1878,1880,1881,1882,1883,1884,1885,1889,1890,1894,1895,1896,1897,1898,1899,1900,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000) 
 
failData <- matrix(data = NA, nrow = length(failIndices), ncol = 2, byrow = TRUE, dimnames = list(NULL,c("Experiment","Error")))

failData[,1] <- failIndices
failData[,2] <- 1

#mainTitle <- "Failed Experiments - Multiple Partition 2nd Row"
pdfFileName <- paste(removeSpaces(mainTitle),".pdf",sep="")
pngFileName <- paste(removeSpaces(mainTitle),".png",sep="")


#pdf(pdfFileName)

 plot(failData,type="h", main=mainTitle, xlim=c(1,2000))
#dev.off()


# Convert pdf to png
system(paste("sips -s format png",pdfFileName,"--out",pngFileName))
